<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seat Booking System</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .seat-container { display: flex; justify-content: center; }
        .seat { margin: 10px; text-align: center; cursor: pointer; }
        .seat img { width: 100px; height: auto; }
        .grey { filter: grayscale(100%); opacity: 0.5; }
        #timer { text-align: center; font-size: 20px; }
        #tom-jerry { position: absolute; top: 0; left: 0; width: 200px; animation: chase 10s linear infinite; }
        @keyframes chase { 0% { left: -200px; } 100% { left: 100%; } }
        #special-page { display: none; text-align: center; }
        #letter { display: none; background: pink; padding: 20px; animation: unfold 2s; }
        @keyframes unfold { 0% { height: 0; } 100% { height: auto; } }
        #heart { display: none; width: 100px; height: 100px; background: red; clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%); animation: break 2s; }
        @keyframes break { 0% { transform: scale(1); } 50% { background: orange; } 100% { transform: scale(0); background: black; } }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body>
    <h1>Seat Booking</h1>
    <div id="timer"></div>
    <div class="seat-container" id="seats"></div>
    <img id="tom-jerry" src="https://media1.giphy.com/media/jyTk0vpfS0pyqkgpZu/giphy.gif" alt="Tom and Jerry">
    <div id="special-page">
        <h2>I Love You</h2>
        <img src="https://www.instagram.com/p/DO5QP1JCD_P/media/?size=l" alt="Sharon">
        <audio autoplay loop>
            <source src="https://www.youtube.com/embed/Pvhpfoi7PEY?autoplay=1" type="audio/mpeg">
        </audio>
    </div>
    <div id="letter"></div>
    <div id="heart"></div>

    <script>
        // Replace with your Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const seatsRef = db.ref('seats');

        const deadline = new Date(2025, 9, 20); // October 20, 2025
        const whatsappNumber = '1234567890'; // Replace with the actual WhatsApp number

        // Initialize seats if not exist
        seatsRef.once('value').then(snapshot => {
            if (!snapshot.exists()) {
                const initialSeats = {};
                for (let i = 1; i <= 5; i++) {
                    initialSeats[i] = { booked: false, user: null };
                }
                seatsRef.set(initialSeats);
            }
        });

        // Timer
        function updateTimer() {
            const now = new Date();
            const diff = deadline - now;
            if (diff <= 0) {
                document.getElementById('timer').innerText = 'Booking closed!';
                return;
            }
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            document.getElementById('timer').innerText = `Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
        }
        setInterval(updateTimer, 1000);

        // Render seats
        function renderSeats(seats) {
            const container = document.getElementById('seats');
            container.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const seat = document.createElement('div');
                seat.className = 'seat';
                const img = document.createElement('img');
                img.src = 'https://www.shutterstock.com/image-photo/empty-theater-auditorium-cinema-red-260nw-441531358.jpg';
                seat.appendChild(img);
                const label = document.createElement('p');
                label.innerText = `Seat ${i}` + (i === 1 ? ' (CEO Vincent)' : '');
                seat.appendChild(label);
                if (seats[i].booked) {
                    seat.classList.add('grey');
                } else {
                    seat.onclick = () => bookSeat(i);
                }
                container.appendChild(seat);
            }
        }

        // Listen for changes
        seatsRef.on('value', snapshot => {
            const seats = snapshot.val();
            renderSeats(seats);
        });

        // Trivia
        function passTrivia() {
            const q1 = prompt('Who is the CEO?').toLowerCase();
            if (q1 !== 'vincent') return false;
            const q2 = prompt('What\'s the toughest slimmest iPhone?').toLowerCase();
            if (q2 !== 'iphone 17 air') return false;
            return true;
        }

        // Book seat
        function bookSeat(seatId) {
            const now = new Date();
            if (now > deadline) {
                alert('Booking closed!');
                return;
            }

            if (!passTrivia()) {
                alert('Trivia failed! Cannot book.');
                return;
            }

            const name = prompt('Enter your name:');
            if (!name) return;

            const isSharon = name.toLowerCase() === 'sharon wacheke';

            if (isSharon) {
                document.getElementById('special-page').style.display = 'block';
            }

            const phone = prompt('Enter your phone number:');
            if (!phone) return;
            if (phone === '0793022244' && seatId >= 5) {
                alert('You are only allowed seats 1-4.');
                return;
            }

            const id = prompt('Enter your ID:');
            if (!id) return;

            const age = parseInt(prompt('Enter your age:'));
            if (isNaN(age) || age < 18) {
                alert('Must be at least 18 years old.');
                return;
            }

            const howKnow = prompt('How do you know vincevision?');
            if (!howKnow) {
                alert('This is required.');
                return;
            }

            const phoneModel = prompt('Choose phone model (iPhone 14 Pro, Pro Max, Plain - all 256GB, or Samsung S25 Ultra):');
            if (!phoneModel) return;

            const shoeSize = prompt('Enter your shoe size:');
            if (!shoeSize) return;

            const info = `Name: ${name}\nPhone: ${phone}\nID: ${id}\nAge: ${age}\nHow know vincevision: ${howKnow}\nPhone Model: ${phoneModel}\nShoe Size: ${shoeSize}\nSeat: ${seatId}`;
            if (confirm(`Confirm booking:\n${info}`)) {
                seatsRef.child(seatId).update({
                    booked: true,
                    user: { name, phone, id, age, howKnow, phoneModel, shoeSize }
                });
                alert(`Seat ${seatId} booked by ${name}!`);
                confetti();
                if (isSharon) {
                    const letter = document.getElementById('letter');
                    letter.innerHTML = `<p>Dear Sharon, I love you so much. Vincent will always be there for you. [Heartfelt message...]</p>
                    <button onclick="loveYes()">I love you too</button>
                    <button onclick="loveNo()">I don't love you</button>`;
                    letter.style.display = 'block';

                    // Cute cartoon - add a gif or something
                    // For example, add another img similar to tom-jerry

                    // Rose petals - use confetti with rose colors
                    confetti({ particleCount: 100, spread: 70, colors: ['#ff0000', '#pink'] });
                }
                // Redirect to WhatsApp
                setTimeout(() => {
                    window.location.href = `https://wa.me/${whatsappNumber}?text=Booking confirmed: ${encodeURIComponent(info)}`;
                }, 5000); // After 5 secs
            }
        }

        function loveYes() {
            alert('Cute lovers animation!');
            // Play animation
            confetti();
        }

        function loveNo() {
            const heart = document.getElementById('heart');
            heart.style.display = 'block';
            setTimeout(() => {
                heart.style.display = 'none';
                alert('You are a bad girl for fun!');
                // Crash simulation
                document.body.innerHTML = '<h1>Site crashed!</h1>';
                setTimeout(() => {
                    location.reload();
                }, 3000);
            }, 2000);
            // Then only I love you button
        }
    </script>
</body>
</html>
